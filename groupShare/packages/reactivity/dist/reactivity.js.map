{
  "version": 3,
  "sources": ["../../shared/src/index.ts", "../src/effect.ts", "../src/handler.ts", "../src/reactive.ts"],
  "sourcesContent": ["export const isObject = (value) => {\n  return value !== null && typeof value === 'object'\n}\n", "export let activeEffect = undefined\n\nexport class ReactiveEffect {\n  constructor(private fn) {}\n  parent = undefined\n  deps = []\n  run() {\n    try {\n      this.parent = activeEffect\n      activeEffect = this\n      return this.fn()\n    } finally {\n      activeEffect = this.parent\n      this.parent = undefined\n    }\n  }\n}\n\nexport function effect(fn) {\n  const _effect = new ReactiveEffect(fn)\n  _effect.run()\n}\n\nconst targetMap = new WeakMap()\n\nexport function track(target, key) {\n  if (activeEffect) {\n    let depsMap = targetMap.get(target)\n    if (!depsMap) {\n      targetMap.set(target, (depsMap = new Map()))\n    }\n    let dep = depsMap.get(key)\n    if (!dep) {\n      depsMap.set(key, (dep = new Set()))\n    }\n    let shouldTrack = !dep.has(activeEffect)\n    if (shouldTrack) {\n      dep.add(activeEffect)\n      activeEffect.deps.push(dep)\n    }\n  }\n}\n\nexport function trigger(target, key, value, oldValue) {\n  const depsMap = targetMap.get(target)\n  if (!depsMap) return\n  const dep = depsMap.get(key)\n  dep &&\n    dep.forEach((effect) => {\n      if (effect !== activeEffect) {\n        effect.run()\n      }\n    })\n}\n", "import { track, trigger } from './effect'\nimport { ReactiveFlag } from './reactive'\n\nexport const mutableHandlers = {\n  get(target, key, receiver) {\n    if (key === ReactiveFlag.IS_REACTIVE) {\n      return true\n    }\n    const res = Reflect.get(target, key, receiver)\n    track(target, key)\n    return res\n  },\n  set(target, key, value) {\n    let oldValue = target[key]\n    const r = Reflect.set(target, key, value)\n    if (oldValue !== value) {\n      trigger(target, key, value, oldValue)\n    }\n    return r\n  },\n}\n", "import { isObject } from '@vue/shared'\nimport { mutableHandlers } from './handler'\n\nexport const enum ReactiveFlag {\n  IS_REACTIVE = '__v_isReactive',\n}\n\nconst reactiveMap = new WeakMap()\n\nexport function reactive(target) {\n  if (!isObject(target)) return target\n  let existingProxy = reactiveMap.get(target)\n  if (existingProxy) return existingProxy\n  if (target[ReactiveFlag.IS_REACTIVE]) return target\n  const proxy = new Proxy(target, mutableHandlers)\n  reactiveMap.set(target, proxy)\n  return proxy\n}\n"],
  "mappings": ";AAAO,IAAM,WAAW,CAAC,UAAU;AACjC,SAAO,UAAU,QAAQ,OAAO,UAAU;AAC5C;;;ACFO,IAAI,eAAe;AAEnB,IAAM,iBAAN,MAAqB;AAAA,EAC1B,YAAoB,IAAI;AAAJ;AACpB,kBAAS;AACT,gBAAO,CAAC;AAAA,EAFiB;AAAA,EAGzB,MAAM;AACJ,QAAI;AACF,WAAK,SAAS;AACd,qBAAe;AACf,aAAO,KAAK,GAAG;AAAA,IACjB,UAAE;AACA,qBAAe,KAAK;AACpB,WAAK,SAAS;AAAA,IAChB;AAAA,EACF;AACF;AAEO,SAAS,OAAO,IAAI;AACzB,QAAM,UAAU,IAAI,eAAe,EAAE;AACrC,UAAQ,IAAI;AACd;AAEA,IAAM,YAAY,oBAAI,QAAQ;AAEvB,SAAS,MAAM,QAAQ,KAAK;AACjC,MAAI,cAAc;AAChB,QAAI,UAAU,UAAU,IAAI,MAAM;AAClC,QAAI,CAAC,SAAS;AACZ,gBAAU,IAAI,QAAS,UAAU,oBAAI,IAAI,CAAE;AAAA,IAC7C;AACA,QAAI,MAAM,QAAQ,IAAI,GAAG;AACzB,QAAI,CAAC,KAAK;AACR,cAAQ,IAAI,KAAM,MAAM,oBAAI,IAAI,CAAE;AAAA,IACpC;AACA,QAAI,cAAc,CAAC,IAAI,IAAI,YAAY;AACvC,QAAI,aAAa;AACf,UAAI,IAAI,YAAY;AACpB,mBAAa,KAAK,KAAK,GAAG;AAAA,IAC5B;AAAA,EACF;AACF;AAEO,SAAS,QAAQ,QAAQ,KAAK,OAAO,UAAU;AACpD,QAAM,UAAU,UAAU,IAAI,MAAM;AACpC,MAAI,CAAC;AAAS;AACd,QAAM,MAAM,QAAQ,IAAI,GAAG;AAC3B,SACE,IAAI,QAAQ,CAACA,YAAW;AACtB,QAAIA,YAAW,cAAc;AAC3B,MAAAA,QAAO,IAAI;AAAA,IACb;AAAA,EACF,CAAC;AACL;;;AClDO,IAAM,kBAAkB;AAAA,EAC7B,IAAI,QAAQ,KAAK,UAAU;AACzB,QAAI,4CAAkC;AACpC,aAAO;AAAA,IACT;AACA,UAAM,MAAM,QAAQ,IAAI,QAAQ,KAAK,QAAQ;AAC7C,UAAM,QAAQ,GAAG;AACjB,WAAO;AAAA,EACT;AAAA,EACA,IAAI,QAAQ,KAAK,OAAO;AACtB,QAAI,WAAW,OAAO;AACtB,UAAM,IAAI,QAAQ,IAAI,QAAQ,KAAK,KAAK;AACxC,QAAI,aAAa,OAAO;AACtB,cAAQ,QAAQ,KAAK,OAAO,QAAQ;AAAA,IACtC;AACA,WAAO;AAAA,EACT;AACF;;;ACjBO,IAAW,eAAX,kBAAWC,kBAAX;AACL,EAAAA,cAAA,iBAAc;AADE,SAAAA;AAAA,GAAA;AAIlB,IAAM,cAAc,oBAAI,QAAQ;AAEzB,SAAS,SAAS,QAAQ;AAC/B,MAAI,CAAC,SAAS,MAAM;AAAG,WAAO;AAC9B,MAAI,gBAAgB,YAAY,IAAI,MAAM;AAC1C,MAAI;AAAe,WAAO;AAC1B,MAAI,OAAO;AAA2B,WAAO;AAC7C,QAAM,QAAQ,IAAI,MAAM,QAAQ,eAAe;AAC/C,cAAY,IAAI,QAAQ,KAAK;AAC7B,SAAO;AACT;",
  "names": ["effect", "ReactiveFlag"]
}
